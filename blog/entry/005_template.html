<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html" charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <link rel="alternate" type="application/atom+xml" title="Atom" href="http://songmu.github.io/p5-Riji/blog/atom.xml">
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/css/bootstrap.min.css" rel="stylesheet">
  <title>Riji tutorial</title>
</head>
<body>
  <header>
    <h1><a href="http://songmu.github.io/p5-Riji/blog/">Riji tutorial</a></h1>
  </header>
  <section>
<article>
  <div class="entry">
    <h1>005. テンプレートファイルの編集</h1>

<p>前回、静的ファイルを配置する方法について説明しましたが、今回はいよいよテンプレートファイルの編集を行います。これでひと通りRijiの基本機能をマスターして、自分のBlogサイトを構築できるようになるでしょう。</p>

<h2>テンプレートディレクトリ</h2>

<p>テンプレートはshare/tmplに配置します。初期状態では以下のようになっています。</p>

<pre><code>% tree share/tmpl
share/tmpl
├── base.tx
├── default.tx
├── entry.tx
├── index.tx
└── tag.tx
</code></pre>

<p>テンプレートにはPerlの高速テンプレートエンジンである<a href="http://xslate.org/">Xslate</a>を採用しており、拡張子は.txとなっています。Xslateにはいくつかシンタックスがあるのですが、Rijiでは標準のシンタックスである"Kolon"を利用しています。</p>

<h2>Kolonのシンタックスについて</h2>

<p>詳しくは<a href="http://xslate.org/">公式ページ</a>から辿れるドキュメント等に説明を譲りますが、KolonはPerl6ライクな文法を提供するテンプレートエンジンになっています。各変数の頭には<code>$</code>がついています。一度代入した変数には最大入不可能であることに注意して下さい。以下のようにすることで変数の中見を描画することができます。</p>

<pre><code>&lt;: $bar :&gt;
</code></pre>

<p>Rijiではテンプレート描画時にテンプレートに自動的にいくつかの変数が渡されます。</p>

<h2>初期テンプレートの役割について</h2>

<h3>base.tx</h3>

<p>ベースのテンプレートです。Xslateにはテンプレート継承という概念があり、base.txはすべての継承元のテンプレートとして使うことが想定されています。もちろんそれに強制的に従う必要はありません。</p>

<p>すべてのページには変数<code>$blog</code>が渡されますが、このページでもその変数を使うことができます。</p>

<h3>default.tx</h3>

<p>標準のテンプレートです。article直下のmdファイルに対応するコンテンツを描画するのに利用されます。<code>riji setup</code>でarticle/archives.md というファイルが作られて、archives.html というアドレスでアクセス可能になっているかと思いますが、それはこのテンプレートを使って描画されています。</p>

<p><code>$blog</code>の他に<code>$article</code>という変数が渡されます。</p>

<h3>entry.tx</h3>

<p>ブログエントリー描画用のテンプレートです。中見を見るとわかると思いますが、標準で前後のエントリーへのリンクなどが記述されていることが分かるでしょう。</p>

<p><code>$blog</code>の他に<code>$entry</code>という変数が渡されます。</p>

<h3>index.tx</h3>

<p>ブログの全体トップページ用のテンプレートです。</p>

<p><code>$blog</code>の他に<code>$article</code>という変数が渡されます。</p>

<h3>tag.tx</h3>

<p>タグページ用のテンプレートです。タグとは何でしょうか？</p>

<p>実はRijiではBlogエントリにタグを付けることができるのですが、今回はそれには触れません。</p>

<p><code>$blog</code>の他に<code>$tag</code>という変数が渡されます。</p>

<h2>変数について</h2>

<p>自動的に渡されるそれぞれの変数には様々なプロパティやメソッドがぶら下がっています。どんなプロパティやメソッドがあるかはここでは細かくは触れませんが、初期テンプレートの中見を見て参考にしてみて下さい。余力があればRiji本体のソースコードを読んでみて下さい。</p>

<h2>mdファイル内でのXslate記述について</h2>

<p>MarkdownはHTMLを直接記載可能なマークアップ書式であり、かつ、mdファイルの中でXslateの記法も使えることは前回説明したとおりなので、結構複雑なテンプレートをmdファイルの上に書くことも可能です。あまりオススメはしません。</p>

<p>今回はここまでです。</p>

<h2>次回の内容</h2>

<p>テンプレートの編集まで終わり、ひと通りサイトを編集できるようになったと思います。次回はブログ記事にメタ情報を付加する方法について説明します。今回触れられなかったタグについても少し取り上げます。</p>

  </div>
</article>
  </section>
  <footer>
  </footer>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
  <script src="//netdna.bootstrapcdn.com/bootstrap/3.0.0-rc1/js/bootstrap.min.js"></script>
  <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
  <script>$(function(){$('pre > code').addClass('prettyprint');prettyPrint();});</script>
</body>
</html>
